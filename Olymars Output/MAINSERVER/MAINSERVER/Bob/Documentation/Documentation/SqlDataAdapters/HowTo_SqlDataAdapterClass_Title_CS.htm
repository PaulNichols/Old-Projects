<html>
	<head>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<title>
			SqlDataAdapter_Title - Using the SqlDataAdapter class in Visual C# .NET
		</title>
		<link href="../StyleSheet.css" type="text/css" rel="stylesheet">
	</head>
	<body>
		<div class="FirstLevelTitle">
			SqlDataAdapter_Title
		</div>
		<div class="FirstLevelSubTitle">
			&nbsp;&nbsp;&nbsp;Using the SqlDataAdapter class in Visual C# .NET
		</div>
		<hr>
			<div class="MainTitle">
				Overview
			</div>
			<blockquote>
				<div class="MainBody">
					This class was generated for the [<a href="../Tables/Title.htm">Title</a>] table.
					It is located in the
					<span class="FixedHighlight">
					Bob.SqlDataAdapters
					</span>
					namespace.<br>
					<br>
					Please note that this class relies on the following underlying stored procedures:
					<br>
					<ul>
						<li>
							[<a href="../Stored_Procedures/spI_Title.htm">spI_Title</a>]
						</li>
						<li>
							[<a href="../Stored_Procedures/spU_Title.htm">spU_Title</a>]
						</li>
						<li>
							[<a href="../Stored_Procedures/spD_Title.htm">spD_Title</a>]
						</li>
						<li>
							[<a href="../Stored_Procedures/spS_Title.htm">spS_Title</a>]
						</li>
					</ul>
					To read an overview on this class, click <a href="HowTo_SqlDataAdapterClass_Title.htm">here</a>.<br>
					To see the members of this class, click <a href="SqlDataAdapterClass_Title_Members.htm">here</a>.<br>
					To see an example on how to call this class in Visual Basic .NET, click <a href="HowTo_SqlDataAdapterClass_Title_VB.htm">here</a>.
				</div>
			</blockquote>
			<hr>
			<div class="MainTitle">
				Step by step tutorial
			</div>
			<blockquote>
				<div class="MainTitle">
					First Step:
				</div>
				<blockquote>
					<div class="MainBody">
						If you are in Visual Studio.NET, make a reference to the following
						assembly: "Bob.dll".
					</div>
					<br>
					<div class="MainBody">
						If you are using the compiler, be sure to add a "/r:" switch pointing
						on the following assembly: "Bob.dll".
					</div>
				</blockquote>
				<div class="MainTitle">
					Second Step:
				</div>
				<blockquote>
					<div class="MainBody">
						From <b>Visual Studio.NET</b>, create a new "Visual C# Projects/Windows Application" project. On the default form (Form1),
						add the following controls:
						<br>
						<ul>
							<li>
								<b>Button</b> (name: cmdRefresh, Text: Refresh)
							</li>
							<li>
								<b>Button</b> (name: cmdUpdate, Text: Update)
							</li>
							<li>
								<b><a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemWindowsFormsDataGridClassTopic.htm">DataGrid</a></b> (name: dataGrid1)
							</li>
						</ul>
					</div>
					<div class="MainBody">
						add thoses directives at the top of your code:
					</div>
					<div class="Code">
						using Bob.DataClasses;<br>
						using SqlDataAdapters = Bob.SqlDataAdapters;
					</div>
					<br>
					<div class="MainBody">
						Declare the two following class level variables:
					</div>
					<div class="Code">
						SqlDataAdapters.SqlDataAdapter_Title sqlDataAdapter_Title;<br>
						System.Data.DataSet CurrentDataSet = null;<br>
					</div>
				</blockquote>
				<div class="MainTitle">
					Third Step:
				</div>
				<blockquote>
					<div class="MainBody">
						Double-click on the "<b>cmdRefresh</b>" button and paste the following code:
					</div>
					<br>
					<div class="Code">
						private void cmdRefresh_Click(object sender, System.EventArgs e)<br>
						{<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;// Let's build a connection string to the database.<br>
							&nbsp;&nbsp;&nbsp;&nbsp;// Note: the connection string policy is described <a href="../Stored_Procedures/spS_Title_CS.htm#Connection">here</a>.<br>
							&nbsp;&nbsp;&nbsp;&nbsp;// <br>
							&nbsp;&nbsp;&nbsp;&nbsp;// To see the documentation on how to build this connection string,<br>
							&nbsp;&nbsp;&nbsp;&nbsp;// <a href="ms-help://MS.NETFrameworkSDKv1.1/cpref/html/frlrfSystemDataSqlClientSqlConnectionClassConnectionStringTopic.htm">click here</a>
						</div>
&nbsp;&nbsp;&nbsp;&nbsp;						string ConnectionString =<br>&nbsp;&nbsp;&nbsp;&nbsp;Information.BuildConnectionString("MAINSERVER\MAINSERVER", "Bob");<br>
						<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;// Let's instanciate the SqlDataAdapter class.<br>
						</div>
						&nbsp;&nbsp;&nbsp;&nbsp;sqlDataAdapter_Title = new SqlDataAdapters.SqlDataAdapter_Title(ConnectionString);<br>
						<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;// Let's instanciate a new <a href="ms-help://MS.NETFrameworkSDK/cpref/html/frlrfSystemDataDataSetClassTopic.htm">DataSet</a> class.<br>
						</div>
						&nbsp;&nbsp;&nbsp;&nbsp;CurrentDataSet = new System.Data.DataSet();<br>
						<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;// Let's use the SqlDataAdapter class to fill this DataSet.<br>
						</div>
					&nbsp;&nbsp;&nbsp;&nbsp;sqlDataAdapter_Title.FillDataSet(ref CurrentDataSet);<br>
						<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;// Let's load the DataGrid with the DataSet content.<br>
						</div>
						&nbsp;&nbsp;&nbsp;&nbsp;dataGrid1.DataSource = CurrentDataSet.Tables["Title"].DefaultView;<br>
						}<br>
					</div>
					<br>
					<div class="MainBody">
						Double-click on the "<b>cmdUpdate</b>" button and paste the following code:
					</div>
					<br>
					<div class="Code">
						private void cmdUpdate_Click(object sender, System.EventArgs e)<br>
						{<br>
						&nbsp;&nbsp;&nbsp;&nbsp;try<br>
						&nbsp;&nbsp;&nbsp;&nbsp;{<br>
						<div class="FixedComment">
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Let's update all the changes that have been made in the DataGrid<br>
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// by invoking the underlying SqlDataAdapter.<br>
						</div>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sqlDataAdapter_Title.SqlDataAdapter.Update(CurrentDataSet, "Title");<br>
						&nbsp;&nbsp;&nbsp;&nbsp;}<br>
						&nbsp;&nbsp;&nbsp;&nbsp;catch (System.Data.SqlClient.SqlException Exception)<br>
						&nbsp;&nbsp;&nbsp;&nbsp;{<br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox.Show(Exception.ToString());<br>
						&nbsp;&nbsp;&nbsp;&nbsp;}<br>
						}<br>
					</div>
					<br>
					<div class="MainBody">
						Hit <b>F5</b> to run this project. Click on the "<b>Refresh</b> button.
						Make what ever changes you want (Add a new record, Update an
						existing record and delete an existing record). Click on the "<b>Update</b>
						button. All the changes have been populated back to your database.
					</div>
				</blockquote>
			</blockquote>
		</blockquote>
		<hr>
		<div class="Copyright">
			This documentation was automatically generated on:
			Sunday 02 January 2005 - 12:33:23
		</div>
		<br>
		<div class="Copyright">
			SQL Server Centric .NET Code Generator<br>
			OlyMars v 1.0.1697.21165<br>
		</div>
	</body>
</html>
