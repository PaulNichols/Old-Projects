<html>
	<head>
		<meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5">
		<title>
			spS_tblOrderItem_Full - SQL Script
		</title>
		<link href="../StyleSheet.css" type="text/css" rel="stylesheet">
	</head>
	<body>
		<div class="FirstLevelTitle">
			spS_tblOrderItem_Full
		</div>
		<div class="FirstLevelSubTitle">
			&nbsp;&nbsp;&nbsp;SQL Script
		</div>
		<hr>
		<div class="MainTitle">
			T-SQL code for this stored procedure
		</div>
		<blockquote>
			<div class="MainBody" style="background-color: gainsboro;">
				Create Procedure [spS_tblOrderItem_Full]<br>
				<br>
				/*<br>
				Retrieve specific records from the [tblOrderItem] table, as well as all its foreign tables, depending on the input parameters you supply:<br>
				&nbsp;&nbsp;&nbsp;[tblOrder] (via [Oit_GuidOrderID])<br>
				&nbsp;&nbsp;&nbsp;[tblProduct] (via [Oit_GuidProductID])<br>
				*/<br>
				<br>
				(<br>
				 @Oit_GuidID [uniqueidentifier] = Null -- for [tblOrderItem].[Oit_GuidID] column<br>
				,@Oit_GuidOrderID [uniqueidentifier] = Null -- for [tblOrderItem].[Oit_GuidOrderID] column<br>
				,@Oit_GuidProductID [uniqueidentifier] = Null -- for [tblOrderItem].[Oit_GuidProductID] column<br>
				,@ReturnXML [bit] = 0 -- Indicates if we want to get back XML content instead of normal resultset (@ReturnXML = 1 to get XML back)<br>
				)<br>
				<br>
				-- Returns the number of records found<br>
				<br>
				As<br>
				<br>
				/*<br>
				&nbsp;&nbsp;&nbsp;This T-SQL code was automatically generated using:<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Server Centric .NET Code Generator<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v 1.0.1287.20792<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generation Date: 28/11/2004 11:31:14<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generator name: &lt;Developer Name Here&gt;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template last update: 24/06/2002 01:53:57<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template revision: 15083637<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Server version: 08.00.0194<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server: MAINSERVER\MAINSERVER<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Database: [OlymarsDemo]<br>
				<br>
				&nbsp;&nbsp;&nbsp;WARNING: This source is provided &quot;AS IS&quot; without warranty of any kind.<br>
				&nbsp;&nbsp;&nbsp;The author disclaims all warranties, either express or implied, including<br>
				&nbsp;&nbsp;&nbsp;the warranties of merchantability and fitness for a particular purpose.<br>
				&nbsp;&nbsp;&nbsp;In no event shall the author or its suppliers be liable for any damages<br>
				&nbsp;&nbsp;&nbsp;whatsoever including direct, indirect, incidental, consequential, loss of<br>
				&nbsp;&nbsp;&nbsp;business profits or special damages, even if the author or its suppliers<br>
				&nbsp;&nbsp;&nbsp;have been advised of the possibility of such damages.<br>
				*/<br>
				<br>
				<br>
				--&nbsp;&nbsp;&nbsp;IMPORTANT:<br>
				--&nbsp;&nbsp;&nbsp;Changes to this SQL code may cause incorrect behavior<br>
				--&nbsp;&nbsp;&nbsp;and will be lost if the code is regenerated. <br>
				<br>
				<br>
				If @ReturnXML Is Null<br>
				&nbsp;&nbsp;&nbsp;Set @ReturnXML = 0<br>
				<br>
				If @ReturnXML = 0<br>
				&nbsp;&nbsp;&nbsp;Begin<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [tblOrderItem_Records].[Oit_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_LngAmount]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_DatOrderedOn]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_LngCustomerID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_CurTotal]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_StrName]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_CurPrice]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_LngCategoryID]<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From [fntblOrderItem_Full](@Oit_GuidID, @Oit_GuidOrderID, @Oit_GuidProductID) As [tblOrderItem_Records]<br>
				&nbsp;&nbsp;&nbsp;End<br>
				<br>
				Else<br>
				<br>
				&nbsp;&nbsp;&nbsp;Begin<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [tblOrderItem_Records].[Oit_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_LngAmount]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_DatOrderedOn]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_LngCustomerID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidOrderID_Ord_CurTotal]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_GuidID]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_StrName]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_CurPrice]<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,[tblOrderItem_Records].[Oit_GuidProductID_Pro_LngCategoryID]<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From [fntblOrderItem_Full](@Oit_GuidID, @Oit_GuidOrderID, @Oit_GuidProductID) As [tblOrderItem_Records]<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For XML Auto, Elements, XMLData, BINARY BASE64<br>
				&nbsp;&nbsp;&nbsp;End<br>
				<br>
				Return(@@RowCount)<br>
				
			</div>
		</blockquote>
		<hr>
		<a name="Function">
		<div class="MainTitle">
			T-SQL code for the underlying inline table-valued function used by this stored procedure
		</div>
		<blockquote>
			<div class="MainBody" style="background-color: gainsboro;">
				Create Function [fntblOrderItem_Full]<br>
				<br>
				(<br>
				 @Oit_GuidID [uniqueidentifier] = Null<br>
				,@Oit_GuidOrderID [uniqueidentifier] = Null<br>
				,@Oit_GuidProductID [uniqueidentifier] = Null<br>
				)<br>
				<br>
				/*<br>
				&nbsp;&nbsp;&nbsp;This T-SQL code was automatically generated using:<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Server Centric .NET Code Generator<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v 1.0.1287.20792<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generation Date: 28/11/2004 11:31:14<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generator name: &lt;Developer Name Here&gt;<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template last update: 24/06/2002 01:53:57<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template revision: 15083637<br>
				<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SQL Server version: 08.00.0194<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Server: MAINSERVER\MAINSERVER<br>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Database: [OlymarsDemo]<br>
				<br>
				&nbsp;&nbsp;&nbsp;WARNING: This source is provided &quot;AS IS&quot; without warranty of any kind.<br>
				&nbsp;&nbsp;&nbsp;The author disclaims all warranties, either express or implied, including<br>
				&nbsp;&nbsp;&nbsp;the warranties of merchantability and fitness for a particular purpose.<br>
				&nbsp;&nbsp;&nbsp;In no event shall the author or its suppliers be liable for any damages<br>
				&nbsp;&nbsp;&nbsp;whatsoever including direct, indirect, incidental, consequential, loss of<br>
				&nbsp;&nbsp;&nbsp;business profits or special damages, even if the author or its suppliers<br>
				&nbsp;&nbsp;&nbsp;have been advised of the possibility of such damages.<br>
				*/<br>
				<br>
				<br>
				--&nbsp;&nbsp;&nbsp;IMPORTANT:<br>
				--&nbsp;&nbsp;&nbsp;Changes to this SQL code may cause incorrect behavior<br>
				--&nbsp;&nbsp;&nbsp;and will be lost if the code is regenerated. <br>
				<br>
				<br>
				Returns Table<br>
				<br>
				As<br>
				<br>
				Return<br>
				(<br>
				Select<br>
				 [tblOrderItem].[Oit_GuidID]<br>
				,[tblOrderItem].[Oit_GuidOrderID]<br>
				,[tblOrderItem].[Oit_GuidProductID]<br>
				,[tblOrderItem].[Oit_LngAmount]<br>
				,[tblOrder1].[Ord_GuidID] [Oit_GuidOrderID_Ord_GuidID]<br>
				,[tblOrder1].[Ord_DatOrderedOn] [Oit_GuidOrderID_Ord_DatOrderedOn]<br>
				,[tblOrder1].[Ord_LngCustomerID] [Oit_GuidOrderID_Ord_LngCustomerID]<br>
				,[tblOrder1].[Ord_CurTotal] [Oit_GuidOrderID_Ord_CurTotal]<br>
				,[tblProduct2].[Pro_GuidID] [Oit_GuidProductID_Pro_GuidID]<br>
				,[tblProduct2].[Pro_StrName] [Oit_GuidProductID_Pro_StrName]<br>
				,[tblProduct2].[Pro_CurPrice] [Oit_GuidProductID_Pro_CurPrice]<br>
				,[tblProduct2].[Pro_LngCategoryID] [Oit_GuidProductID_Pro_LngCategoryID]<br>
				<br>
				From [dbo].[tblOrderItem] [tblOrderItem]<br>
				    Inner Join [dbo].[tblOrder] [tblOrder1] On [tblOrderItem].[Oit_GuidOrderID] = [tblOrder1].[Ord_GuidID]<br>
				        Inner Join [dbo].[tblProduct] [tblProduct2] On [tblOrderItem].[Oit_GuidProductID] = [tblProduct2].[Pro_GuidID]<br>
				<br>
				Where<br>
				<br>
				    ((@Oit_GuidID Is Null) Or ([tblOrderItem].[Oit_GuidID] = @Oit_GuidID))<br>
				And ((@Oit_GuidOrderID Is Null) Or ([tblOrderItem].[Oit_GuidOrderID] = @Oit_GuidOrderID))<br>
				And ((@Oit_GuidProductID Is Null) Or ([tblOrderItem].[Oit_GuidProductID] = @Oit_GuidProductID))<br>
				)<br>
				
			</div>
		</blockquote>
		<hr>
		<div class="Copyright">
			This documentation was automatically generated on:
			Monday 27 December 2004 - 16:15:19
		</div>
		<br>
		<div class="Copyright">
			SQL Server Centric .NET Code Generator<br>
			Olymars Library v 1.0.1697.21165<br>
		</div>
	</body>
</html>
