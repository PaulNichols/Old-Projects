'------------------------------------------------------------------------------
' <autogenerated>
'     This code was generated by a tool.
'     Runtime Version: 1.1.4322.2032
'
'     Changes to this file may cause incorrect behavior and will be lost if 
'     the code is regenerated.
' </autogenerated>
'------------------------------------------------------------------------------

Option Strict Off
Option Explicit On

'ALTER PROCEDURE dbo.usp_SearchCompletedCitesDocuments
'	(
'		@FromDate Datetime,
'		@ToDate Datetime
'	)

'AS
		
'	SELECT     *
'	FROM         dbo.vSearchCompletedCitesDocuments
'	WHERE     (DateAuthorised >= @FromDate AND DateAuthorised <= @ToDate) OR (DateRefused >= @FromDate AND DateRefused <= @ToDate)

Namespace DataObjects.Views.Service
    
    'Service implementation for table 'vSearchCompletedCitesDocuments'
    '*DO* add your modifications to this file
    Public Class SearchCompletedCitesDocumentsService
        Inherits Base.SearchCompletedCitesDocumentsServiceBase

        Public Shared Function GetDocsByDateRange(ByVal fromDate As DateTime, ByVal todate As DateTime) As Views.Collection.SearchCompletedCitesDocumentsBoundCollection
            'create a command...
            Dim command As System.Data.SqlClient.SqlCommand = New System.Data.SqlClient.SqlCommand("dbo.usp_SearchCompletedCitesDocuments")
            command.CommandType = System.Data.CommandType.StoredProcedure

            'parameters...
            command.Parameters.Add("@FromDate", System.Data.SqlDbType.DateTime).Value = fromDate
            command.Parameters.Add("@ToDate", System.Data.SqlDbType.DateTime).Value = todate

            Dim service As Views.Service.SearchCompletedCitesDocumentsService = Views.Entity.SearchCompletedCitesDocuments.ServiceObject
            Dim docs As Views.EntitySet.SearchCompletedCitesDocumentsSet = CType(service.GetEntitySet(command, GetType(Views.EntitySet.SearchCompletedCitesDocumentsSet)), Views.EntitySet.SearchCompletedCitesDocumentsSet)

            command.Dispose()
            Return docs.Entities()
        End Function
    End Class
End Namespace
